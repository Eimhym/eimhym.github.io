<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Youtube Tools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
html,
body {
  margin: 0;
  padding: 0;
  height: 100%;
}
html {
  display: table;
  margin: auto;
}
body {
  display: table-cell;
  vertical-align: middle;
  font-family: Roboto, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

iframe {
  width: 100%;
  height: 100%;
}
input {
  font-family: monospace;
  font-size: 11pt;
}
</style>
</head>
<body>
<table>
<tr><td>Embed</td></tr>
<tr>
<td><input type="text" id="embedPaste" placeholder="paste" size="42"></td>
</tr>
<tr><td><img id="embedThumb"></td></tr>
<tr><td><a id="embedURL" style="text-decoration:none"></a></td></tr>
<tr><td><a id="yewtubeURL" style="text-decoration:none"></a></td></tr>
</table>
<script>
!function(g, el){
  if(! el ) return;

  const re = /^https:\/\/www\.youtube\.com\/embed\/[^&]+$/;
  
  g.embedOpen = function(){
    var url = el.value;
    if( re.test(url) )
      window.open(url, '_blank').focus(); 
  }
}(this, document.getElementById("embedPaste"));

!function(el, img, link, yewtube){
if(! el ) return;
const re = /:\/\/[wm]+\.youtube\.com\/watch\?v=([^&]+)/
el.onpaste = function( evt )
{
  evt.preventDefault();
  var url = evt.clipboardData.getData('text/plain').match(re);
  if( url ){
    var id = url[1];
    el.value = "https://www.youtube.com/embed/" + url[1];
    // console.log();
    if( typeof fetch != 'undefined'){
      fetch("https://noembed.com/embed?dataType=json&url=https://www.youtube.com/watch?v=" + url[1])
        .then(function(res){ return res.json() })
        .then(function(data){
            img.width = data.thumbnail_width;
            img.height = data.thumbnail_height;
            img.src = data.thumbnail_url;
            link.href = el.value;
            link.text = data.title
            yewtube.href = "https://yewtu.be/watch?v=" + id;
            yewtube.text = yewtube.href
            console.log('fetch', data);
        });
    }
  } else {
    el.value = '';
    el.placeholder = "Invalid URL";
    el.blur();
    window.setTimeout(function(){
      el.placeholder = "paste";
    }, 1500);
  }
}}(document.getElementById("embedPaste"), document.getElementById("embedThumb"), document.getElementById("embedURL"), document.getElementById("yewtubeURL"));
</script>
</body>
</html>
